---
apiVersion: v1
kind: ConfigMap
metadata:
  name: driving-school-config
  namespace: driving-school-manager
  labels:
    app: driving-school-manager
    version: "1.0"
data:
  NODE_ENV: "production"
  PORT: "4000"
  LOG_LEVEL: "info"
  METRICS_ENABLED: "true"

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: driving-school-scripts
  namespace: driving-school-manager
  labels:
    app: driving-school-manager
data:
  healthcheck.js: |
    #!/usr/bin/env node
    
    const http = require('http');
    
    const options = {
      hostname: 'localhost',
      port: 4000,
      path: '/health',
      method: 'GET',
      timeout: 2000
    };
    
    const request = http.request(options, (res) => {
      if (res.statusCode === 200) {
        process.exit(0);
      } else {
        process.exit(1);
      }
    });
    
    request.on('error', () => {
      process.exit(1);
    });
    
    request.on('timeout', () => {
      request.destroy();
      process.exit(1);
    });
    
    request.end();
